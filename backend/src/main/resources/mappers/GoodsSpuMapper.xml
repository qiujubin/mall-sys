<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gec.dao.GoodsSpuMapper">

    <!-- 分页查询商品列表（包含品牌和分类名称） -->
    <select id="selectPageWithNames" resultType="com.gec.domain.vo.GoodsSpuVO">
        SELECT 
            gs.id,
            gs.spu_name as spuName,
            gs.spu_desc as spuDesc,
            gs.spu_images as spuImages,
            gs.category_id as categoryId,
            gc.category_name as categoryName,
            gs.brand_id as brandId,
            tb.brand_name as brandName,
            gs.status,
            gs.create_time as createTime,
            gs.update_time as updateTime
        FROM tbl_goods_spu gs
        LEFT JOIN tbl_goods_category gc ON gs.category_id = gc.id
        LEFT JOIN tbl_brand tb ON gs.brand_id = tb.id
        <where>
            gs.deleted = 0
            <if test="keyword != null and keyword != ''">
                AND gs.spu_name LIKE CONCAT('%', #{keyword}, '%')
            </if>
            <if test="brandId != null">
                AND gs.brand_id = #{brandId}
            </if>
            <if test="categoryId != null">
                AND gs.category_id = #{categoryId}
            </if>
        </where>
        ORDER BY gs.create_time DESC
    </select>

</mapper>
